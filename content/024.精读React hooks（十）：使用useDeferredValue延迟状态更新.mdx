---
title: ç²¾è¯»React hooksï¼ˆåï¼‰ï¼šä½¿ç”¨useDeferredValueå»¶è¿ŸçŠ¶æ€æ›´æ–°
description: useDeferredValueå¸¦æ¥çš„æ˜¯å¯å»¶è¿Ÿçš„çŠ¶æ€æ›´æ–°ï¼Œå½“å®é™…å·¥ä½œä¸­é‡åˆ°å¤§æ•°æ®é‡æ¸²æŸ“çš„åœºæ™¯ï¼Œä¸å¦¨å¼•å…¥useDeferredValueè¯•è¯•ã€‚
slug: react-hook-useDeferredValue
slugId: 0ca90f65-4cc3-4a64-a6ab-de0b2fde87a3
tags: React
date: 2023-09-15
---

ä¸Šä¸€ç¯‡æ–‡ç« ï¼ˆã€Š[ç²¾è¯»React hookï¼ˆä¹ï¼‰ï¼šä½¿ç”¨useTransitionè¿›è¡Œéé˜»å¡æ¸²æŸ“](/article/react-hook-useTransition)ã€‹ï¼‰æˆ‘ä»¬å­¦ä¹ äº†ï¼Œåœ¨React v18çš„å¹¶å‘æ¨¡å¼ä¸‹ï¼Œä½¿ç”¨`useTransition`å¯ä»¥åœ¨å¯†é›†è®¡ç®—çš„åœºæ™¯ä¸‹è®©UIæ— é˜»å¡ã€‚React v18è¿˜å¼•å…¥äº†ä¸€ä¸ªå’Œ`useTransition`ç›¸ä¼¼çš„hookï¼Œå°±æ˜¯`useDeferredValue`ã€‚ä¸ºä»€ä¹ˆè¯´ç›¸ä¼¼å‘¢ï¼Œå› ä¸º`useDeferredValue`çš„ä½œç”¨æ˜¯ï¼šå»¶è¿ŸæŸä¸ªå€¼çš„æ›´æ–°ï¼Œä½¿é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡å¯ä»¥å…ˆè¡Œå®Œæˆã€‚

å¼€å§‹å­¦ä¹ `useDeferredValue`ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ˜ç¡®`useTransition`å’Œ`useDeferredValue`çš„å·®å¼‚ï¼š

- `useTransition`ä¸»è¦å…³æ³¨ç‚¹æ˜¯**çŠ¶æ€çš„è¿‡æ¸¡**ã€‚å®ƒå…è®¸å¼€å‘è€…æ§åˆ¶æŸä¸ªæ›´æ–°çš„å»¶è¿Ÿæ›´æ–°ï¼Œè¿˜æä¾›äº†è¿‡æ¸¡æ ‡è¯†ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿæ·»åŠ è¿‡æ¸¡åé¦ˆã€‚
- `useDeferredValue`ä¸»è¦å…³æ³¨ç‚¹æ˜¯**å•ä¸ªå€¼çš„å»¶è¿Ÿæ›´æ–°**ã€‚å®ƒå…è®¸ä½ æŠŠç‰¹å®šçŠ¶æ€çš„æ›´æ–°æ ‡è®°ä¸ºä½ä¼˜å…ˆçº§ã€‚

ç®€è€Œè¨€ä¹‹ï¼Œå¦‚æœä½ æƒ³æä¾›è¿‡æ¸¡åé¦ˆï¼Œå°±ç”¨`useTransition`ï¼Œå¦‚æœä¸éœ€è¦æä¾›è¿‡æ¸¡åé¦ˆï¼Œç”¨`useDeferredValue`å°±å¯ä»¥ã€‚

## `useDeferredValue`åŸºç¡€ä½¿ç”¨

```jsx
const deferredValue = useDeferredValue(someValue);
```

å…¶ä¸­`someValue`æ˜¯ä½ æƒ³è¦å»¶è¿Ÿçš„å€¼ï¼Œå®ƒå¯ä»¥æ˜¯ä»»ä½•ç±»å‹ã€‚

`deferredValue`çš„æ¸²æŸ“æœ‰ä¸¤ç§æƒ…å†µï¼š

1. **åœ¨åˆå§‹æ¸²æŸ“æ—¶**ï¼Œ`deferredValue`çš„å€¼å°†ä¸`someValue`çš„å€¼ç›¸åŒã€‚
2. **åœ¨UIæ›´æ–°æœŸé—´**ï¼Œå› ä¸º`deferredValue`çš„ä¼˜å…ˆçº§è¾ƒä½ï¼Œå³ä½¿å¹¶å‘æ¨¡å¼ä¸‹`deferredValue`å·²åœ¨åå°æ›´æ–°ï¼ŒReactä¹Ÿä¼šå…ˆä½¿ç”¨æ—§å€¼æ¸²æŸ“ï¼Œå½“å…¶å®ƒé«˜ä¼˜å…ˆçº§çš„çŠ¶æ€æ›´æ–°å®Œæˆï¼Œæ‰ä¼šæŠŠ`deferredValue`æ–°å€¼æ¸²æŸ“å‡ºæ¥ã€‚

### ç¤ºä¾‹åˆ†æ

æƒ³è±¡ä¸€ä¸ªåœºæ™¯ï¼Œä½ åœ¨å¤§æ•°æ®é‡åœºæ™¯ä¸‹åšæŸ¥è¯¢ï¼Œå‰ç«¯æ¸²æŸ“å°±éœ€è¦å»¶è¿Ÿæ›´æ–°åˆ—è¡¨ï¼Œè¿˜å¸Œæœ›åªæœ‰æœ€åä¸€æ¬¡æŸ¥è¯¢çš„æ•°æ®è¢«ä¿ç•™ï¼Œè¿™æ—¶å€™`useDeferredValue`å°±æ´¾ä¸Šç”¨åœºäº†ï¼Œä¾‹å¦‚ï¼š

```jsx
import { useState, useDeferredValue, memo } from 'react';

export default function App() {
  const [text, setText] = useState('');
  const deferredText = useDeferredValue(text);
  return (
    <>
			{/* è¾“å…¥æ¡†çš„å€¼ç›´æ¥ä¸ text ç»‘å®šï¼Œæ‰€ä»¥è¾“å…¥æ¡†ä¼šå®æ—¶æ˜¾ç¤ºç”¨æˆ·çš„è¾“å…¥ */}
      <input value={text} onChange={e => setText(e.target.value)} />
			{/* SlowList ç»„ä»¶æ¥å— deferredText ä½œä¸ºå±æ€§ï¼Œæ¸²æŸ“ä¼˜å…ˆçº§ä¼šè¢«é™ä½ */}
			{/* åœ¨ UI çœŸæ­£æ›´æ–°å‰ï¼Œå¦‚æœ deferredText è¢«æ›´æ–°å¤šæ¬¡ï¼Œä¹Ÿåªä¼šä¿ç•™æœ€åä¸€æ¬¡çš„ç»“æœ */}
      <SlowList text={deferredText} />
    </>
  );
}

const SlowList = memo(function SlowList({ text }) {
  const arr = [];
  for (let i = 0; i < 200; i++) {
    let startTime = performance.now();
    while (performance.now() - startTime < 1) {}
    if (String(i).includes(text)) {
      arr.push(<li key={i}>{i}</li>);
    }
  }
  return (
    <ul className="items">
      {arr}
    </ul>
  );
});
```

å¦‚æœä½ æƒ³å¯¹ç…§ä¸ç”¨`useDeferredValue`çš„æ•ˆæœï¼Œåªè¦æŠŠ`<SlowList>`ä¿®æ”¹æ‰å°±å¯ä»¥

```jsx
<SlowList text={text} />
```

çº¿ä¸Šç¤ºä¾‹å¯ä»¥æ¥[ğŸ‘‰æˆ‘çš„æ¼”ç¤ºç«™](https://nextjs.weijunext.com//hooks/useDeferredValue)ä½“éªŒã€‚

## ä½¿ç”¨`useDeferredValue`æ³¨æ„äº‹é¡¹

- `useDeferredValue`ä»…åœ¨å¼€å¯Reactå¹¶å‘æ¨¡å¼çš„æ—¶å€™æ‰æœ‰æ•ˆ
    
    ```jsx
    // React v18ä»¥å‰
    ReactDOM.render(<app />, rootNode) // âŒ æ— æ³•å¼€å¯useTransition
    
    // React v18
    ReactDOM.createRoot(rootNode).render(<app />) // âœ… å¼€å¯useTransition
    ```
    
- ä¼ é€’ç»™`useDeferredValue`çš„å€¼åº”è¯¥æ˜¯**åŸå§‹å€¼**ï¼ˆå¦‚å­—ç¬¦ä¸²å’Œæ•°å­—ï¼‰æˆ–**åœ¨æ¸²æŸ“å¤–éƒ¨åˆ›å»ºçš„å¯¹è±¡**ã€‚
    
    ä¸ºä»€ä¹ˆå¯¹è±¡éœ€è¦åˆ›å»ºåœ¨å¤–éƒ¨åˆ›å»ºï¼Ÿè¿™å…¶å®å’ŒJavaScriptçš„æœºåˆ¶æœ‰å…³ï¼Œå³ä½¿æ¯æ¬¡åˆ›å»ºç›¸åŒçš„å¯¹è±¡ï¼ŒJavaScriptä¾ç„¶ä¼šæ¯æ¬¡ç”Ÿæˆæ–°çš„å¼•ç”¨ã€‚è¿™æ„å‘³ç€æ¯æ¬¡ä½ åœ¨ç»„ä»¶çš„æ¸²æŸ“å‡½æ•°ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡å¹¶å°†å…¶ä¼ é€’ç»™`useDeferredValue`ï¼Œä½ éƒ½æ˜¯åœ¨ä¼ é€’ä¸€ä¸ªæ–°çš„ã€ä¸ä¸Šä¸€æ¬¡æ¸²æŸ“ä¸åŒçš„å¼•ç”¨ã€‚
    
    ```jsx
    function MyComponent() {
      const obj = { name: 'John' }; // æ¯æ¬¡ MyComponent é‡æ–°æ¸²æŸ“æ—¶ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ obj å¯¹è±¡ï¼Œå®ƒä»¬çš„å¼•ç”¨æ˜¯ä¸åŒçš„
    
    	// useDeferredValue é€šè¿‡ Object.is æ¥æ£€æŸ¥å€¼æ˜¯å¦æœ‰å˜åŒ–ï¼Œå¼•ç”¨ä¸åŒçš„å¯¹è±¡ä¼šè¢«å½“ä½œä¸åŒçš„å€¼
      const deferredValue = useDeferredValue(obj);
    
      // ...å…¶ä»–ä»£ç ...
    }
    ```
    
- å½“åŒä¸€ä¸ª`useDeferredValue`åœ¨æ¸²æŸ“å‰æ¥æ”¶åˆ°å¤šæ¬¡ä¸åŒçš„å€¼æ—¶ï¼Œåªæœ‰æœ€åä¸€ä¸ªä¼šè¢«æ¸²æŸ“ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå‰ç«¯åœ¨åšå¤§æ•°æ®é‡æŸ¥è¯¢çš„æ—¶å€™ï¼Œæˆ‘ä»¬å½“ç„¶å¸Œæœ›åªæœ‰æœ€åä¸€æ¬¡æŸ¥è¯¢çš„æ•°æ®æˆåŠŸæ¸²æŸ“ã€‚
- å’Œ`useTransition`ä¸€æ ·ï¼Œ`useDeferredValue`åªä¼šä¸­æ–­æˆ–å»¶è¿ŸUIçš„æ¸²æŸ“ï¼Œ**ä¸ä¼šé˜»æ­¢ç½‘ç»œè¯·æ±‚**ã€‚
- `useDeferredValue`ä¸`<Suspense>`ç»“åˆä½¿ç”¨ï¼Œåœ¨`useDeferredValue`æ›´æ–°æ—¶ï¼Œ`<Suspense>`çš„fallbackæ˜¯ä¸ä¼šå‡ºç°çš„ï¼Œé¡µé¢ä¸Šæ˜¯ç»§ç»­æ˜¾ç¤º`useDeferredValue`çš„æ—§å€¼ã€‚è¿™ä¸€ç‚¹å’Œ`useTransition`ä¸ä¸€æ ·ã€‚

## å’ŒèŠ‚æµã€é˜²æŠ–çš„å…³ç³»

ä»ä¸Šé¢çš„å­¦ä¹ å¯ä»¥çœ‹å‡ºæ¥ï¼Œ`useDeferredValue`åœ¨æŸäº›åœºæ™¯ä¸‹æ˜¯å¯ä»¥æ›¿æ¢æ‰èŠ‚æµå’Œé˜²æŠ–çš„ï¼Œæˆ‘ä»¬å…ˆæ¥åˆ†æå®ƒä»¬å„è‡ªçš„ç‰¹æ€§ï¼Œç„¶åçœ‹çœ‹å®ƒä»¬åˆ†åˆ«é€‚ç”¨ä»€ä¹ˆåœºæ™¯ï¼Ÿ

**é˜²æŠ–ä¸èŠ‚æµçš„å±€é™æ€§**ï¼š

- è¿™ä¸¤ç§æ–¹æ³•éƒ½æ˜¯ä¸ºäº†æ§åˆ¶å‡½æ•°çš„æ‰§è¡Œé¢‘ç‡ï¼Œä½†å®ƒä»¬æ˜¯é˜»å¡çš„ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¸æµç•…çš„ç”¨æˆ·ä½“éªŒã€‚

**`useDeferredValue`çš„ä¼˜åŠ¿**ï¼š

- å®ƒä¸Reactæ·±åº¦é›†æˆï¼Œå¯ä»¥é€‚åº”ç”¨æˆ·çš„è®¾å¤‡ã€‚å¦‚æœè®¾å¤‡æ€§èƒ½å¥½ï¼Œå»¶è¿Ÿçš„é‡æ–°æ¸²æŸ“ä¼šå¾ˆå¿«å®Œæˆï¼›å¦‚æœè®¾å¤‡æ€§èƒ½å·®ï¼Œé‡æ–°æ¸²æŸ“ä¼šç›¸åº”åœ°å»¶è¿Ÿã€‚
- å®ƒä¸éœ€è¦é€‰æ‹©å›ºå®šçš„å»¶è¿Ÿï¼Œä¸é˜²æŠ–å’ŒèŠ‚æµä¸åŒã€‚
- ç”±`useDeferredValue`æ‰§è¡Œçš„é‡æ–°æ¸²æŸ“æ˜¯å¯ä¸­æ–­çš„ã€‚è¿™æ„å‘³ç€åœ¨Reacté‡æ–°æ¸²æŸ“æœŸé—´ï¼Œå¦‚æœå‘ç”Ÿäº†å…¶ä»–æ›´æ–°ï¼ŒReactä¼šä¸­æ–­å½“å‰çš„æ¸²æŸ“å¹¶å¤„ç†æ–°çš„æ›´æ–°ã€‚

**é€‚ç”¨åœºæ™¯**ï¼š

- å¦‚æœè¦ä¼˜åŒ–çš„å·¥ä½œä¸æ˜¯åœ¨æ¸²æŸ“æœŸé—´è¿›è¡Œçš„ï¼Œä¾‹å¦‚å‡å°‘ç½‘ç»œè¯·æ±‚ï¼Œé‚£ä¹ˆé˜²æŠ–å’ŒèŠ‚æµä»ç„¶æ˜¯æœ‰ç”¨çš„ã€‚
- å¦‚æœä¼˜åŒ–çš„ç›®æ ‡æ˜¯å’Œæ¸²æŸ“æœ‰å…³çš„ï¼Œå»ºè®®ä½¿ç”¨`useDeferredValue`

## ç»“è¯­

`useDeferredValue`å¸¦æ¥çš„æ˜¯å¯å»¶è¿Ÿçš„çŠ¶æ€æ›´æ–°ï¼Œå½“å®é™…å·¥ä½œä¸­é‡åˆ°å¤§æ•°æ®é‡æ¸²æŸ“çš„åœºæ™¯ï¼Œä¸å¦¨æƒ³æƒ³æ˜¯å¦å¼•å…¥`useDeferredValue`ã€‚

## ä¸“æ èµ„æº

ä¸“æ åšå®¢åœ°å€ï¼š[ç²¾è¯»React Hooks](/tag/React)

ä¸“æ æ¼”ç¤ºç«™ï¼š[React Hooks Demos](https://nextjs.weijunext.com/hooks)

ä¸“æ æºç ä»“åº“ï¼šğŸ‘‰[Github - Source Code](https://github.com/weijunext/nextjs-learn-demos)

äº¤ä¸ªæœ‹å‹ï¼šğŸ‘‰[åŠ å…¥ã€Œç‹¬ç«‹å…¨æ ˆäº¤æµç¾¤ã€](/make-a-friend)

ä¸“æ æ–‡ç« åˆ—è¡¨ï¼š

[ç²¾è¯»React hooksï¼ˆä¸€ï¼‰ï¼šuseState çš„å‡ ä¸ªåŸºç¡€ç”¨æ³•å’Œè¿›é˜¶æŠ€å·§](/article/react-hook-useState)

[ç²¾è¯»React hooksï¼ˆäºŒï¼‰ï¼šReactçŠ¶æ€ç®¡ç†çš„å¼ºå¤§å·¥å…·â€”â€”useReducer](/article/react-hook-useReducer)

[ç²¾è¯»React hooksï¼ˆä¸‰ï¼‰ï¼šuseContextä»åŸºç¡€åº”ç”¨åˆ°æ€§èƒ½ä¼˜åŒ–](/article/react-hook-useContext)

[ç²¾è¯»React hooksï¼ˆå››ï¼‰ï¼šuseRefçš„å¤šç»´ç”¨é€”](/article/react-hook-useRef)

[ç²¾è¯»React hooksï¼ˆäº”ï¼‰ï¼šuseEffectä½¿ç”¨ç»†èŠ‚çŸ¥å¤šå°‘ï¼Ÿ](/article/react-hook-useEffect)

[ç²¾è¯»React hooksï¼ˆå…­ï¼‰ï¼šuseLayoutEffectè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ](/article/react-hook-useLayoutEffect)

[ç²¾è¯»React hooksï¼ˆä¸ƒï¼‰ï¼šç”¨useMemoæ¥å‡å°‘æ€§èƒ½å¼€é”€](/article/react-hook-useMemo)

[ç²¾è¯»React hooksï¼ˆå…«ï¼‰ï¼šæˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦useCallback](/article/react-hook-useCallback)

[ç²¾è¯»React hooksï¼ˆä¹ï¼‰ï¼šä½¿ç”¨useTransitionè¿›è¡Œéé˜»å¡æ¸²æŸ“](/article/react-hook-useTransition)

[ç²¾è¯»React hooksï¼ˆåï¼‰ï¼šä½¿ç”¨useDeferredValueå»¶è¿ŸçŠ¶æ€æ›´æ–°](/article/react-hook-useDeferredValue)

[ç²¾è¯»React hooksï¼ˆåä¸€ï¼‰ï¼šuseInsertionEffectâ€”â€”CSS-in-JSæ ·å¼æ³¨å…¥æ–°æ–¹å¼](/article/react-hook-useInsertionEffect)

[ç²¾è¯»React hooksï¼ˆåäºŒï¼‰ï¼šä½¿ç”¨useImperativeHandleèƒ½è·å¾—ä»€ä¹ˆèƒ½åŠ›](/article/react-hook-useImperativeHandle)

[ç²¾è¯»React hooksï¼ˆåä¸‰ï¼‰ï¼šä½¿ç”¨useSyncExternalStoreè·å–å®æ—¶æ•°æ®](/article/react-hook-useSyncExternalStore)

[ç²¾è¯»React hooksï¼ˆåå››ï¼‰ï¼šæ€»æœ‰ä¸€å¤©ä½ ä¼šéœ€è¦useIdä¸ºä½ ç”Ÿæˆå”¯ä¸€id](/article/react-hook-useId)

[ç²¾è¯»React hooksï¼ˆåäº”ï¼‰ï¼šæŠŠuseDebugValueåŠ å…¥ä½ çš„Reactè°ƒè¯•å·¥å…·åº“](/article/react-hook-useDebugValue)

[ç²¾è¯»React hooksï¼ˆåå…­ï¼‰ï¼šä¸€ä¸ªä¸ºä»£ç ä¼˜é›…è€Œç”Ÿçš„hookâ€”â€”use](/article/react-hook-use)