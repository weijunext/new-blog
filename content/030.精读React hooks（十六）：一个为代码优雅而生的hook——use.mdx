---
title: ç²¾è¯»React hooksï¼ˆåå…­ï¼‰ï¼šä¸€ä¸ªä¸ºä»£ç ä¼˜é›…è€Œç”Ÿçš„hookâ€”â€”use
description: use æ˜¯ä¸€ä¸ªèƒ½è®©ä½ çš„ä»£ç æ›´ä¼˜é›…çš„hookï¼Œè™½ç„¶å®ƒè¿˜ä¸æ˜¯ä¸€ä¸ªæ­£å¼å‘å¸ƒçš„ hookï¼Œä½†è¿™ä¸å¦¨ç¢æˆ‘ä»¬å­¦ä¹ ã€‚
slug: react-hook-use
slugId: 4a9829b4-64ea-4254-bcf6-a9a2eb9cd131
tags: React
date: 2023-09-21
---

`use` æ˜¯ React å®˜æ–¹æœ€æ–°æ¨å‡ºçš„ hookï¼ˆæˆªæ­¢2023.9.21ï¼‰ï¼Œæœ¬æ–‡ä¹Ÿæ˜¯ã€Š[ç²¾è¯»React hook](/tag/React)ã€‹ç³»åˆ—æ–‡ç« çš„æœ€åä¸€ç¯‡ã€‚

æˆªæ­¢å‘æ–‡æ—¥æœŸï¼Œ`use` è¿˜æ˜¯ä¸€ä¸ªé¢„å‘å¸ƒçš„ hookï¼Œå°†æ¥æœ‰å¯èƒ½ä¼šè¿›è¡Œç ´åæ€§æ›´æ–°ï¼Œæ‰€ä»¥ä¸æ¨èåœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ã€‚ä½†è¿™ä¸å¦¨ç¢æˆ‘ä»¬å­¦ä¹ ï¼Œä¸‡ä¸€è¿‡æ®µæ—¶é—´ `use` è½¬æ­£äº†å‘¢ï¼Ÿ

## `use`çš„ä½¿ç”¨

`use` å¯ä»¥è®©ä½ åœ¨å‡½æ•°ç»„ä»¶ä¸­è¯»å–ç±»ä¼¼äº Promise æˆ– context çš„èµ„æºçš„å€¼ã€‚å®ƒçš„åŸºç¡€ç”¨æ³•å¦‚ä¸‹ï¼š

```jsx
import { use } from 'react';

function MessageComponent({ messagePromise }) {
  const message = use(messagePromise);
  const theme = use(ThemeContext);
  // ...
}
```

`use` å‡½æ•°çš„å‚æ•°æ˜¯ä½ æƒ³è¦è¯»å–çš„èµ„æºï¼Œèµ„æºå¯ä»¥æ˜¯ Promise æˆ– Contextï¼ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯ `messagePromise` å’Œ `ThemeContext`ï¼‰ï¼Œå¹¶è¿”å›ä»èµ„æºä¸­è¯»å–çš„å€¼ã€‚

### `use`è§£å†³çš„é—®é¢˜åœºæ™¯

åœ¨è¿‡å»ï¼ŒReact å¼€å‘è€…åœ¨å¤„ç†ç±»ä¼¼äº Promise æˆ– Context çš„èµ„æºæ—¶ï¼Œé€šå¸¸éœ€è¦å°†è¿™äº›èµ„æºçš„å€¼å­˜å‚¨åœ¨ state ä¸­ï¼Œç„¶ååœ¨ç»„ä»¶ä¸­é€šè¿‡ props æˆ– state æ¥ä½¿ç”¨è¿™äº›å€¼ã€‚è¿™ç§æ–¹æ³•è™½ç„¶å¯è¡Œï¼Œä½†æ˜¯ä¼šå¢åŠ ä»£ç çš„å¤æ‚æ€§ï¼Œå¹¶å¯èƒ½å¯¼è‡´çŠ¶æ€ç®¡ç†çš„å›°éš¾ã€‚

`use` è¿™ä¸ª hook è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºå®ƒè®©ä½ èƒ½å¤Ÿç›´æ¥åœ¨ç»„ä»¶ä¸­è°ƒç”¨å¹¶è·å–è¿™äº›èµ„æºçš„å€¼ï¼Œè¿™æ ·å¯ä»¥ç®€åŒ–ä»£ç ï¼Œä½¿å…¶æ›´æ˜“äºç†è§£å’Œç»´æŠ¤ã€‚

æƒ³è±¡ä¸€ä¸ªåœºæ™¯ï¼ŒåŠ å…¥ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåšå®¢åº”ç”¨ï¼Œè¿™ä¸ªåº”ç”¨éœ€è¦ä» `API` è·å–åšå®¢æ–‡ç« çš„å†…å®¹ï¼Œä¸ç”¨ `use` çš„æ—¶å€™ï¼Œä½ ä¼šè¿™ä¹ˆåšï¼š

```jsx
import { useState, useEffect } from 'react';

function BlogPostComponent({ postId }) {
  const [post, setPost] = useState(null);

  useEffect(() => {
    fetchPost(postId).then(data => setPost(data));
  }, [postId]);

  // ...
}
```

ç”¨ä¸Š `use`ï¼Œå°±å¯ä»¥è¿™ä¹ˆåšï¼š

```jsx
import { use } from 'react';

function BlogPostComponent({ postId }) {
  const postPromise = fetchPost(postId);
  const post = use(postPromise);
  // ...
}
```

åœ¨åŠŸèƒ½ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯ç”¨äº† `use` æ˜æ˜¾ä»£ç æ›´ä¼˜é›…äº†ã€‚

### `use`ç”¨äºæ¡ä»¶è¯­å¥å’Œå¾ªç¯ä¸­

å…¶ä»– React hook ä¸åŒï¼Œ`use` å¯ä»¥åœ¨ç»„ä»¶é‡Œçš„å¾ªç¯å’Œæ¡ä»¶è¯­å¥ä¸­ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼š

- æ ¹æ®åšå®¢å†…å®¹ç±»åˆ«ï¼Œè¯»å–ä¸åŒ Promise

```jsx
import { use } from 'react';

function ResourceComponent({ resourceType }) {
  let resource;

  if (resourceType === 'post') {
    const postPromise = fetchPost();
    resource = use(postPromise);
  } else if (resourceType === 'comment') {
    const commentPromise = fetchComment();
    resource = use(commentPromise);
  }

  // ...
}
```

- åœ¨ç»„ä»¶é‡Œè¯»å–ä¸€ä¸ªåŒ…å«å¤šä¸ªèµ„æºçš„æ•°ç»„

```jsx
import { use } from 'react';

function ResourceListComponent({ resourcePromises }) {
  const resources = resourcePromises.map(resourcePromise => use(resourcePromise));

  // ...
}
```

### å°†æ•°æ®ä»æœåŠ¡å™¨æµå¼ä¼ é€’ç»™å®¢æˆ·ç«¯

äº†è§£ NextJS v13 çš„åŒå­¦éƒ½çŸ¥é“ï¼Œåœ¨ app router æ¨¡å¼ä¸‹ï¼Œä½ å¯ä»¥åœ¨æœåŠ¡ç«¯ç»„ä»¶é‡Œé¢åµŒå¥—å®¢æˆ·ç«¯ç»„ä»¶ï¼Œè€Œè¿™ç§æ–¹å¼å°±èƒ½å®ç°æŠŠæœåŠ¡ç«¯ç»„ä»¶è·å–çš„æ•°æ®ä¼ é€’ç»™å®¢æˆ·ç«¯ç»„ä»¶ã€‚è¿™æ˜¯æœ¬èŠ‚è¦è®²è¿°çš„çŸ¥è¯†çš„åŸºç¡€ï¼Œå¦‚æœä½ è¿˜ä¸æ‡‚è¿™äº›æ¦‚å¿µï¼Œå¯ä»¥åˆ°æˆ‘çš„å¦ä¸€ç¯‡æ–‡ç« ã€Š[NextJS v13æœåŠ¡ç«¯ç»„ä»¶å’Œå®¢æˆ·ç«¯ç»„ä»¶åŠæœ€ä½³å®è·µ](/article/nextjs-v13-server-side-and-client-side-components-best-practices)ã€‹å­¦ä¹ ä¸€ä¸‹ã€‚

ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨æœåŠ¡å™¨ç»„ä»¶ä¸­åˆ›å»ºä¸€ä¸ªPromiseï¼Œå¹¶å°†å…¶ä½œä¸ºpropä¼ é€’ç»™å®¢æˆ·ç«¯ç»„ä»¶ï¼š

```jsx
// æœåŠ¡å™¨ç»„ä»¶
function ServerComponent({ postId }) {
  const postPromise = fetchPost(postId);
  return <ClientComponent postPromise={postPromise} />;
}

// å®¢æˆ·ç«¯ç»„ä»¶
import { use } from 'react';

function ClientComponent({ postPromise }) {
  const post = use(postPromise);
  // ...
}
```

åœ¨ `ClientComponent` ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ `use` è¿™ä¸ªHookæ¥è¯»å– `ServerComponent` ä¼ è¿‡æ¥çš„ Promiseã€‚

å¦‚æœä¸ç”¨ `use`ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ `ServerComponent` ç”¨ `await` æ¥å®Œæˆè¯·æ±‚ï¼Œç„¶åæŠŠè¯·æ±‚ç»“æœé€šè¿‡propä¼ ç»™ `ClientComponent`ï¼Œä¸è¿‡ `await` ä¼šåœ¨æ‰§è¡Œå®Œæˆå‰é˜»å¡æœåŠ¡ç«¯ç»„ä»¶çš„æ¸²æŸ“ï¼Œè€Œä½¿ç”¨ `use` ä¸ä¼šå½±å“æœåŠ¡ç«¯ç»„ä»¶çš„æ¸²æŸ“ã€‚

### å¤„ç† rejected Promise

æœ‰ Promise çš„åœ°æ–¹å°±è¦æä¾›å¤„ç† rejected Promise çš„æ–¹æ³•ã€‚å½“ä½ ä½¿ç”¨useçš„æ—¶å€™ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§æ–¹æ³•å¯ä»¥å¤„ç† rejected Promiseï¼š

#### 1ã€ErrorBoundary

æˆ‘ä»¬å¯ä»¥ç”¨ `ErrorBoundary` åŒ…è£¹å¯èƒ½å‡ºé”™çš„ç»„ä»¶ï¼Œå¦‚æœä¼ é€’ç»™ `use` çš„ Promise rejected äº†ï¼Œå°†æ˜¾ç¤º `ErrorBoundary` çš„ fallbackï¼š

```jsx
"use client";
import { use, Suspense } from "react";
import { ErrorBoundary } from "react-error-boundary";

export function BlogPostComponent() {
  const postPromise = fetchPost(postId);

  return (
    <ErrorBoundary fallback={<p>âš ï¸Something went wrong</p>}>
      <Suspense fallback={<p>âŒ›Loading...</p>}>
        <BlogPostTitle messagePromise={messagePromise} />
      </Suspense>
    </ErrorBoundary>
  );
}

function BlogPostTitle({ postPromise }) {
  const post = use(postPromise);
  // ...

	return <p>Here is the title: {post.title}</p>;
}
```

#### 2ã€Promise.catch

å¦‚æœä½ ä¸æƒ³ç”¨ ï¼Œä½†åˆæƒ³åœ¨ rejected æ—¶æœ‰å€¼å¡«å……ï¼Œå¯ä»¥ä½¿ç”¨ Promise çš„ `catch` æ–¹æ³•ã€‚

```jsx
"use client";
import { use, Suspense } from "react";
import { ErrorBoundary } from "react-error-boundary";

export function BlogPostComponent() {
const postPromise = fetchPost(postId).catch((error) => {
    console.error('Failed to fetch post:', error);
    return 'https://weijunext.com'; // è¿”å›ä¸€ä¸ªé»˜è®¤å€¼
  });

  return (
    <Suspense fallback={<p>âŒ›Loading...</p>}>
      <BlogPostTitle messagePromise={messagePromise} />
    </Suspense>
  );
}
```

## ç»“è¯­

`use` è¿˜åªæ˜¯ä¸€ä¸ªå®éªŒæ€§ï¼Œç­‰å®ƒæ­£å¼è½¬æ­£ä¹‹åï¼Œæƒ³å¿…ä¹Ÿä¼šæˆä¸ºç¤¾åŒºé‡Œå®£ä¼  React ä»£ç ä¼˜åŒ–ä¹‹é“çš„ä¸€é¡¹æŒ‡å—ã€‚

## ä¸“æ ç»“è¯­

å†™å®Œè¿™ç¯‡æ–‡ç« ï¼Œã€Š[ğŸ‘‰ç²¾è¯»React Hooksã€‹](/tag/React)ä¸“æ å°±ç®—å‘Šä¸€æ®µè½äº†ã€‚æœ¬ç³»åˆ—æ–‡ç« è®²è§£äº† 16 ä¸ªå®˜æ–¹æ–‡æ¡£é‡Œåˆ—å‡ºæ¥çš„ hookï¼Œå…¶ä¸­å‰é¢ä¸€åŠåœ¨æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­ç»å¸¸ä½¿ç”¨ï¼Œè€Œåé¢ä¸€åŠå…¶å®é²œæœ‰ä½¿ç”¨ï¼Œè¿™æ˜¯å› ä¸ºåæ¥å‘å¸ƒçš„ hook ä¸»è¦é¢å‘åº“æˆ–è€…ä¸Šå±‚æ¡†æ¶çš„å¼€å‘è€…ã€‚React æºç é‡Œå¯¼å‡ºçš„å…¶å®è¿˜ä¸æ­¢è¿™ 16 ä¸ª hookï¼Œè¿™æ˜¯å› ä¸ºå…¶å®ƒ hook å¯¹ç»å¤§éƒ¨åˆ†å¼€å‘è€…æ¥è¯´æ˜¯ç»æ— æœºä¼šä½¿ç”¨åˆ°çš„ã€‚

æœ¬ä¸“æ çš„ç¼–å†™ç®—æ˜¯æˆ‘çš„ä¸€æ¡æ”¯çº¿ä»»åŠ¡ï¼Œå®Œæˆæœ¬ä¸“æ çš„ç¼–å†™åï¼Œæˆ‘ä¼šç»§ç»­å›å½’ä¸»çº¿ä»»åŠ¡â€”â€”å®æˆ˜é¡¹ç›®çš„ç»éªŒåˆ†äº«ã€‚æˆ‘çš„å·¥ä½œå’Œ side project ä¼šç”¨åˆ°çš„æ ¸å¿ƒæŠ€æœ¯æ ˆæœ‰ï¼šNext.jsã€Reactã€Vueã€Nodeï¼Œå¦‚æœä½ æœ‰å…´è¶£ä¸€èµ·æ¢è®¨ç›¸å…³çŸ¥è¯†ï¼Œä¸å¦¨å…³æ³¨ä¸€ä¸‹ğŸ‘‰[æˆ‘çš„åšå®¢](https://weijunext.com)ã€‚


## ä¸“æ èµ„æº

ä¸“æ åšå®¢åœ°å€ï¼š[ç²¾è¯»React Hooks](/tag/React)

ä¸“æ æ¼”ç¤ºç«™ï¼š[React Hooks Demos](https://nextjs.weijunext.com/hooks)

ä¸“æ æºç ä»“åº“ï¼šğŸ‘‰[Github - Source Code](https://github.com/weijunext/nextjs-learn-demos)

äº¤ä¸ªæœ‹å‹ï¼šğŸ‘‰[åŠ å…¥ã€Œç‹¬ç«‹å…¨æ ˆäº¤æµç¾¤ã€](/make-a-friend)

ä¸“æ æ–‡ç« åˆ—è¡¨ï¼š

[ç²¾è¯»React hooksï¼ˆä¸€ï¼‰ï¼šuseState çš„å‡ ä¸ªåŸºç¡€ç”¨æ³•å’Œè¿›é˜¶æŠ€å·§](/article/react-hook-useState)

[ç²¾è¯»React hooksï¼ˆäºŒï¼‰ï¼šReactçŠ¶æ€ç®¡ç†çš„å¼ºå¤§å·¥å…·â€”â€”useReducer](/article/react-hook-useReducer)

[ç²¾è¯»React hooksï¼ˆä¸‰ï¼‰ï¼šuseContextä»åŸºç¡€åº”ç”¨åˆ°æ€§èƒ½ä¼˜åŒ–](/article/react-hook-useContext)

[ç²¾è¯»React hooksï¼ˆå››ï¼‰ï¼šuseRefçš„å¤šç»´ç”¨é€”](/article/react-hook-useRef)

[ç²¾è¯»React hooksï¼ˆäº”ï¼‰ï¼šuseEffectä½¿ç”¨ç»†èŠ‚çŸ¥å¤šå°‘ï¼Ÿ](/article/react-hook-useEffect)

[ç²¾è¯»React hooksï¼ˆå…­ï¼‰ï¼šuseLayoutEffectè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ](/article/react-hook-useLayoutEffect)

[ç²¾è¯»React hooksï¼ˆä¸ƒï¼‰ï¼šç”¨useMemoæ¥å‡å°‘æ€§èƒ½å¼€é”€](/article/react-hook-useMemo)

[ç²¾è¯»React hooksï¼ˆå…«ï¼‰ï¼šæˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦useCallback](/article/react-hook-useCallback)

[ç²¾è¯»React hooksï¼ˆä¹ï¼‰ï¼šä½¿ç”¨useTransitionè¿›è¡Œéé˜»å¡æ¸²æŸ“](/article/react-hook-useTransition)

[ç²¾è¯»React hooksï¼ˆåï¼‰ï¼šä½¿ç”¨useDeferredValueå»¶è¿ŸçŠ¶æ€æ›´æ–°](/article/react-hook-useDeferredValue)

[ç²¾è¯»React hooksï¼ˆåä¸€ï¼‰ï¼šuseInsertionEffectâ€”â€”CSS-in-JSæ ·å¼æ³¨å…¥æ–°æ–¹å¼](/article/react-hook-useInsertionEffect)

[ç²¾è¯»React hooksï¼ˆåäºŒï¼‰ï¼šä½¿ç”¨useImperativeHandleèƒ½è·å¾—ä»€ä¹ˆèƒ½åŠ›](/article/react-hook-useImperativeHandle)

[ç²¾è¯»React hooksï¼ˆåä¸‰ï¼‰ï¼šä½¿ç”¨useSyncExternalStoreè·å–å®æ—¶æ•°æ®](/article/react-hook-useSyncExternalStore)

[ç²¾è¯»React hooksï¼ˆåå››ï¼‰ï¼šæ€»æœ‰ä¸€å¤©ä½ ä¼šéœ€è¦useIdä¸ºä½ ç”Ÿæˆå”¯ä¸€id](/article/react-hook-useId)

[ç²¾è¯»React hooksï¼ˆåäº”ï¼‰ï¼šæŠŠuseDebugValueåŠ å…¥ä½ çš„Reactè°ƒè¯•å·¥å…·åº“](/article/react-hook-useDebugValue)

[ç²¾è¯»React hooksï¼ˆåå…­ï¼‰ï¼šä¸€ä¸ªä¸ºä»£ç ä¼˜é›…è€Œç”Ÿçš„hookâ€”â€”use](/article/react-hook-use)