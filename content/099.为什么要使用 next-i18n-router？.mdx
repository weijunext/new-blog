---
title: ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ next-i18n-routerï¼Ÿ
description: example
slug: example
tags: NextJS,NextJSå®æˆ˜,i18n
date: 2025-0216
# visible: draft/invisible/publishedï¼Œé»˜è®¤published
# pin: pin
---

Next-i18n-router æ˜¯ä¸€ä¸ªå¯é€‰é¡¹ï¼Œä½†åœ¨ Next.js 14+ çš„ App Router é¡¹ç›®ä¸­ï¼Œæˆ‘å»ºè®®ä½¿ç”¨å®ƒï¼Œå› ä¸ºå®ƒæä¾›äº†ä¸€äº›é‡è¦çš„ä¼˜åŠ¿ã€‚

è®©æˆ‘è§£é‡Šä¸€ä¸‹ä½¿ç”¨ next-i18n-router çš„å¥½å¤„ï¼š

1. **æ›´ç®€å•çš„è·¯ç”±å¤„ç†**
- æ— éœ€ç¼–å†™å¤æ‚çš„ä¸­é—´ä»¶
- è‡ªåŠ¨å¤„ç†è¯­è¨€åˆ‡æ¢é‡å®šå‘
- æ›´å¥½çš„ SEO æ”¯æŒ

2. **æ›´å¥½çš„ç±»å‹æ”¯æŒ**
- æä¾›å®Œæ•´çš„ TypeScript æ”¯æŒ
- è·¯ç”±å‚æ•°ç±»å‹å®‰å…¨

è®©æˆ‘å±•ç¤ºå¦‚ä½•æ•´åˆ next-i18n-routerï¼š

```typescript
// middleware.ts
import { I18nMiddleware } from 'next-i18n-router';
import { languages } from '@/i18n/settings';

const middleware = I18nMiddleware({
  defaultLocale: 'en',
  locales: languages,
  urlMappingStrategy: 'prefix'
});

export default middleware;

export const config = {
  matcher: '/((?!api|static|.*\\..*|_next).*)'
};
```

```typescript
// src/i18n/settings.ts
export const fallbackLng = 'en';
export const languages = ['en', 'zh', 'es'] as const; // ä½¿ç”¨ const æ–­è¨€
export type Lang = (typeof languages)[number];  // TypeScript ç±»å‹

export const defaultNS = 'common';
export const namespaces = ['common', 'home', 'product', 'cart', 'user'] as const;
```

```typescript
// src/components/LanguageSwitcher.tsx
'use client';

import { useRouter, useParams } from 'next/navigation';
import { useTranslation } from 'react-i18next';
import { languages, type Lang } from '@/i18n/settings';

export default function LanguageSwitcher() {
  const router = useRouter();
  const params = useParams();
  const { i18n } = useTranslation();
  
  const currentLang = params.lng as Lang;

  const handleLanguageChange = (lng: Lang) => {
    // next-i18n-router ä¼šè‡ªåŠ¨å¤„ç†è·¯ç”±æ›´æ–°
    const currentPath = window.location.pathname;
    const newPath = currentPath.replace(`/${currentLang}`, `/${lng}`);
    router.push(newPath);
  };

  return (
    <div>
      {languages.map((lng) => (
        <button
          key={lng}
          onClick={() => handleLanguageChange(lng)}
          className={currentLang === lng ? 'active' : ''}
        >
          {lng.toUpperCase()}
        </button>
      ))}
    </div>
  );
}
```

```typescript
// app/[lng]/layout.tsx
import { dir } from 'i18next';
import { languages } from '@/i18n/settings';

export async function generateStaticParams() {
  return languages.map((lng) => ({ lng }));
}

export async function generateMetadata({ params: { lng } }) {
  return {
    title: `My App - ${lng.toUpperCase()}`,
    // å…¶ä»–å…ƒæ•°æ®...
  };
}

export default function RootLayout({
  children,
  params: { lng }
}: {
  children: React.ReactNode;
  params: { lng: string };
}) {
  return (
    <html lang={lng} dir={dir(lng)}>
      <body>{children}</body>
    </html>
  );
}
```

ä¸»è¦ä¼˜åŠ¿ï¼š

1. **è‡ªåŠ¨è·¯ç”±å¤„ç†**
```typescript
// next-i18n-router ä¼šè‡ªåŠ¨å¤„ç†è¿™äº›åœºæ™¯:
// /  -> /en
// /about -> /en/about
// /zh/about -> ä¿æŒä¸å˜
```

2. **ç±»å‹å®‰å…¨**
```typescript
// ç±»å‹é”™è¯¯ä¼šè¢«åŠæ—¶æ•è·
const invalidLang: Lang = 'fr'; // TypeScript é”™è¯¯ï¼š'fr' ä¸æ˜¯æœ‰æ•ˆçš„è¯­è¨€ä»£ç 
```

3. **æ›´ç®€æ´çš„å®ç°**
- ä¸éœ€è¦æ‰‹åŠ¨å¤„ç† cookie
- ä¸éœ€è¦å¤æ‚çš„é‡å®šå‘é€»è¾‘
- æ›´å°‘çš„æ ·æ¿ä»£ç 

4. **æ›´å¥½çš„ç»´æŠ¤æ€§**
- é›†ä¸­çš„è·¯ç”±é…ç½®
- æ¸…æ™°çš„ç±»å‹å®šä¹‰
- æ›´å°‘çš„æ½œåœ¨é”™è¯¯

ä¸è¿‡ï¼Œä¹Ÿæœ‰ä¸€äº›æ³¨æ„äº‹é¡¹ï¼š

1. **æ€§èƒ½è€ƒè™‘**
```typescript
// åœ¨ layout.tsx ä¸­é¢„ç”Ÿæˆè·¯ç”±
export async function generateStaticParams() {
  return languages.map((lng) => ({ lng }));
}
```

2. **API è·¯ç”±å¤„ç†**
```typescript
// middleware.ts
export const config = {
  // æ’é™¤ API è·¯ç”±å’Œé™æ€æ–‡ä»¶
  matcher: '/((?!api|static|.*\\..*|_next).*)'
};
```

æ‰€ä»¥ï¼Œæˆ‘çš„å»ºè®®æ˜¯ï¼šå¦‚æœä½ çš„é¡¹ç›®æ˜¯æ–°çš„ Next.js App Router é¡¹ç›®ï¼Œä½¿ç”¨ next-i18n-router æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒèƒ½:
1. ç®€åŒ–è·¯ç”±é€»è¾‘
2. æä¾›æ›´å¥½çš„ç±»å‹å®‰å…¨
3. å‡å°‘æ ·æ¿ä»£ç 
4. æä¾›æ›´å¥½çš„ç»´æŠ¤æ€§

ä½ è§‰å¾—è¿™ä¸ªå»ºè®®å¦‚ä½•ï¼Ÿæˆ–è€…ä½ å¯¹å…·ä½“å®ç°è¿˜æœ‰ä»€ä¹ˆç–‘é—®å—ï¼Ÿ


## å…³äºæˆ‘

ğŸ§‘â€ğŸ’»ç‹¬ç«‹å¼€å‘ï½œâ›µï¸å‡ºæµ·ï½œNext.jsæ‰‹è‰ºäºº

ğŸ–¥ï¸åšè¿‡å¼€æºï¼šhttp://github.com/weijunext  
âŒ¨ï¸å†™è¿‡åšå®¢ï¼šhttps://weijunext.com  
ğŸ› ï¸ä»Šå¹´æƒ³åšç‹¬ç«‹äº§å“å’Œè¯¾ç¨‹  
ğŸ“˜Nextjsä¸­æ–‡æ–‡æ¡£ï¼šhttp://nextjscn.org  
ğŸ“™å…¨æ ˆå¼€å‘æ•™ç¨‹ï¼šhttps://ship.weijunext.com  

æ¬¢è¿åœ¨ä»¥ä¸‹å¹³å°å…³æ³¨æˆ‘ï¼š

- Twitter: [@weijunext](https://x.com/weijunext)
- Github: [Github](https://github.com/weijunext)
- Blog: [Jå®éªŒå®¤](https://weijunext.com/)
- å³åˆ»: [BigYeç¨‹æ™®](https://m.okjike.com/users/13EF1128-B51B-4D22-8B95-16BB406529F0)
- å¾®ä¿¡äº¤æµç¾¤: [å…¨æ ˆäº¤æµç¾¤](/make-a-friend)

